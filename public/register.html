<!DOCTYPE html>
<html lang="sw">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jisajili - Disc Sales System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #f43f5e;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --dark: #1e293b;
            --light: #f8fafc;
            --gray: #64748b;
            --card-bg: rgba(255, 255, 255, 0.1);
            --glass-bg: rgba(255, 255, 255, 0.1);
            --blur: blur(20px);
        }

        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
        }
        
        body { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            min-height: 100vh; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            padding: 15px;
            position: relative;
            overflow-x: hidden;
        }

        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }

        .bg-bubble {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            animation: float 6s ease-in-out infinite;
        }

        .bubble-1 { width: 60px; height: 60px; top: 10%; left: 5%; animation-delay: 0s; }
        .bubble-2 { width: 80px; height: 80px; top: 70%; left: 85%; animation-delay: 2s; }
        .bubble-3 { width: 40px; height: 40px; top: 85%; left: 15%; animation-delay: 4s; }
        .bubble-4 { width: 70px; height: 70px; top: 15%; left: 75%; animation-delay: 1s; }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-15px) rotate(180deg); }
        }

        .glass-container { 
            background: var(--card-bg); 
            backdrop-filter: var(--blur); 
            border-radius: 20px; 
            border: 1px solid rgba(255,255,255,0.2); 
            box-shadow: 0 15px 35px rgba(0,0,0,0.2); 
            padding: 2rem; 
            width: 100%; 
            max-width: 450px; 
            color: white;
            animation: slideUp 0.6s ease-out;
            margin: 10px;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .logo-container { 
            text-align: center; 
            margin-bottom: 2rem; 
        }
        
        .logo-icon { 
            width: 60px; 
            height: 60px; 
            background: linear-gradient(135deg, #8b5cf6, #6366f1); 
            border-radius: 14px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-size: 1.5rem; 
            color: white; 
            margin: 0 auto 0.75rem; 
            box-shadow: 0 8px 25px rgba(99,102,241,0.4);
        }
        
        .logo-text { 
            font-size: 1.75rem; 
            font-weight: 700; 
            color: white; 
            margin-bottom: 0.25rem; 
            background: linear-gradient(135deg, #fff, #e0e7ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .logo-subtitle { 
            color: rgba(255,255,255,0.8); 
            font-size: 1rem; 
        }
        
        .form-container h2 { 
            font-size: 1.5rem; 
            margin-bottom: 1.5rem; 
            color: white; 
            font-weight: 600; 
            text-align: center; 
        }
        
        .form-group { 
            margin-bottom: 1.25rem; 
            position: relative;
        }
        
        .form-control { 
            background: rgba(255,255,255,0.1); 
            border: 2px solid rgba(255,255,255,0.2); 
            border-radius: 10px; 
            padding: 12px 16px; 
            font-size: 0.95rem; 
            color: white; 
            transition: all 0.3s ease; 
            width: 100%; 
        }
        
        .form-control::placeholder { 
            color: rgba(255,255,255,0.7); 
        }
        
        .form-control:focus { 
            background: rgba(255,255,255,0.15); 
            border-color: rgba(255,255,255,0.4); 
            box-shadow: 0 0 0 2px rgba(255,255,255,0.1); 
            color: white; 
            outline: none; 
        }

        .form-control.is-invalid {
            border-color: var(--danger);
            box-shadow: 0 0 0 2px rgba(239, 68, 68, 0.1);
        }

        .form-control.is-valid {
            border-color: var(--success);
            box-shadow: 0 0 0 2px rgba(16, 185, 129, 0.1);
        }
        
        .password-input { 
            position: relative; 
        }
        
        .toggle-password { 
            position: absolute; 
            right: 12px; 
            top: 50%; 
            transform: translateY(-50%); 
            background: none; 
            border: none; 
            color: rgba(255,255,255,0.7); 
            cursor: pointer; 
            font-size: 1rem; 
            transition: color 0.3s ease;
            z-index: 2;
            padding: 5px;
        }

        .toggle-password:hover {
            color: white;
        }
        
        .password-strength { 
            width: 100%; 
            height: 5px; 
            background: rgba(255,255,255,0.2); 
            border-radius: 3px; 
            margin-top: 0.5rem; 
            overflow: hidden;
        }
        
        .password-strength-bar { 
            height: 100%; 
            width: 0%; 
            border-radius: 3px; 
            transition: all 0.3s ease;
        }
        
        .password-strength-text { 
            font-size: 0.8rem; 
            margin-top: 0.25rem; 
            color: rgba(255,255,255,0.8);
        }

        .password-requirements {
            background: rgba(255,255,255,0.08);
            border-radius: 8px;
            padding: 0.75rem;
            margin-top: 0.5rem;
            font-size: 0.8rem;
        }

        .requirement {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.2rem;
            color: rgba(255,255,255,0.7);
            font-size: 0.75rem;
        }

        .requirement.valid {
            color: var(--success);
        }

        .requirement.valid i {
            color: var(--success);
        }
        
        .form-check { 
            display: flex; 
            align-items: flex-start; 
            gap: 0.6rem; 
            margin-bottom: 1.5rem; 
            color: rgba(255,255,255,0.9); 
            font-size: 0.9rem;
        }
        
        .form-check-input { 
            width: 16px; 
            height: 16px; 
            margin-top: 0.2rem;
            flex-shrink: 0;
        }

        .form-check-input:checked {
            background-color: var(--primary);
            border-color: var(--primary);
        }
        
        .form-check-label { 
            line-height: 1.3;
        }
        
        .form-check-label a { 
            color: white; 
            text-decoration: none; 
            cursor: pointer; 
            font-weight: 600;
            transition: color 0.3s ease;
            white-space: nowrap;
        }
        
        .form-check-label a:hover { 
            color: #e0e7ff; 
            text-decoration: underline; 
        }
        
        .submit-btn { 
            width: 100%; 
            padding: 14px; 
            background: linear-gradient(135deg, var(--primary), var(--primary-dark)); 
            color: white; 
            border: none; 
            border-radius: 10px; 
            font-size: 1rem; 
            font-weight: 600; 
            cursor: pointer; 
            transition: all 0.3s ease; 
            position: relative; 
            overflow: hidden; 
            margin-bottom: 1rem;
        }
        
        .submit-btn:hover { 
            transform: translateY(-2px); 
            box-shadow: 0 8px 25px rgba(99,102,241,0.4); 
        }
        
        .submit-btn:disabled { 
            opacity: 0.7; 
            cursor: not-allowed; 
            transform: none; 
        }
        
        .btn-text, .btn-loading { 
            display: inline-flex; 
            align-items: center; 
            gap: 0.5rem;
            font-size: 0.95rem;
        }
        
        .btn-loading { 
            display: none; 
        }
        
        .login-link { 
            text-align: center; 
            margin-top: 1.5rem; 
            color: rgba(255,255,255,0.8);
            font-size: 0.9rem;
        }
        
        .login-link a { 
            color: white; 
            font-weight: 600; 
            cursor: pointer;
            text-decoration: none;
            transition: color 0.3s ease;
            padding: 6px 12px;
            border-radius: 6px;
            display: inline-block;
            margin-top: 0.5rem;
            font-size: 0.9rem;
        }
        
        .login-link a:hover { 
            color: #e0e7ff; 
            text-decoration: none;
            background: rgba(255,255,255,0.1);
        }
        
        .back-link { 
            text-align: center; 
            margin-top: 1rem; 
        }
        
        .back-link a { 
            color: rgba(255,255,255,0.7); 
            font-size: 0.85rem; 
            cursor: pointer; 
            text-decoration: none;
            transition: color 0.3s ease;
            padding: 5px 10px;
            display: inline-block;
        }
        
        .back-link a:hover { 
            color: white; 
            text-decoration: underline; 
        }
        
        .alert { 
            border-radius: 10px; 
            border: none; 
            margin-top: 1rem; 
            font-size: 0.9rem;
            padding: 0.75rem 1rem;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-8px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .language-switcher {
            position: fixed;
            top: 15px;
            right: 15px;
            z-index: 1000;
        }

        .lang-btn {
            background: rgba(255,255,255,0.15);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            padding: 0.4rem 0.8rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.85rem;
            backdrop-filter: blur(10px);
        }

        .lang-btn:hover {
            background: rgba(255,255,255,0.25);
        }

        .progress-steps {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1.5rem;
            position: relative;
            padding: 0 10px;
        }

        .progress-steps::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 20px;
            right: 20px;
            height: 2px;
            background: rgba(255,255,255,0.2);
            transform: translateY(-50%);
            z-index: 1;
        }

        .step {
            width: 26px;
            height: 26px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 600;
            position: relative;
            z-index: 2;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .step.active {
            background: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.3);
        }

        .step.completed {
            background: var(--success);
        }

        .form-text {
            font-size: 0.8rem;
            margin-top: 0.25rem;
        }

        @media (max-width: 480px) {
            body {
                padding: 10px;
                align-items: flex-start;
                min-height: 100vh;
                height: auto;
            }

            .glass-container { 
                padding: 1.5rem; 
                margin: 5px 0;
                max-width: 100%;
                border-radius: 16px;
            }

            .logo-icon { 
                width: 50px; 
                height: 50px; 
                font-size: 1.25rem; 
                margin-bottom: 0.5rem;
            }
            
            .logo-text { 
                font-size: 1.5rem; 
            }
            
            .logo-subtitle { 
                font-size: 0.9rem; 
            }

            .form-container h2 {
                font-size: 1.3rem;
                margin-bottom: 1.25rem;
            }

            .form-group {
                margin-bottom: 1rem;
            }

            .form-control {
                padding: 10px 14px;
                font-size: 0.9rem;
            }

            .password-requirements {
                padding: 0.6rem;
                font-size: 0.75rem;
            }

            .requirement {
                font-size: 0.7rem;
                margin-bottom: 0.15rem;
            }

            .form-check {
                font-size: 0.85rem;
                margin-bottom: 1.25rem;
            }

            .form-check-input {
                width: 15px;
                height: 15px;
            }

            .submit-btn {
                padding: 12px;
                font-size: 0.95rem;
                margin-bottom: 0.75rem;
            }

            .login-link {
                margin-top: 1.25rem;
                font-size: 0.85rem;
            }

            .back-link {
                margin-top: 0.75rem;
            }

            .language-switcher {
                position: relative;
                top: auto;
                right: auto;
                text-align: center;
                margin-bottom: 1rem;
            }

            .lang-btn {
                position: static;
                display: inline-block;
            }

            .progress-steps {
                margin-bottom: 1.25rem;
            }

            .step {
                width: 24px;
                height: 24px;
                font-size: 0.7rem;
            }
        }
    </style>
</head>
<body>
    <!-- Animated Background -->
    <div class="bg-animation">
        <div class="bg-bubble bubble-1"></div>
        <div class="bg-bubble bubble-2"></div>
        <div class="bg-bubble bubble-3"></div>
        <div class="bg-bubble bubble-4"></div>
    </div>

    <!-- Language Switcher -->
    <div class="language-switcher">
        <button class="lang-btn" onclick="toggleLanguage()">
            <i class="fas fa-globe"></i> 
            <span id="langText">English</span>
        </button>
    </div>

    <div class="glass-container">
        <div class="logo-container">
            <div class="logo-icon"><i class="fas fa-compact-disc"></i></div>
            <div class="logo-text">DISC SALES</div>
            <div class="logo-subtitle" id="registerSubtitle">Fungua Akaunti Mpya</div>
        </div>

        <!-- Progress Steps -->
        <div class="progress-steps">
            <div class="step active" id="step1">1</div>
            <div class="step" id="step2">2</div>
            <div class="step" id="step3">3</div>
        </div>

        <div class="form-container">
            <h2 id="registerTitle">Jisajili</h2>
            
            <form id="registerForm">
                <div class="form-group">
                    <input type="text" class="form-control" placeholder="Jina kamili" required id="regFullName">
                    <div class="form-text text-light opacity-75">
                        <small><i class="fas fa-user"></i> <span id="nameHelp">Jina kamili kama kwenye hati</span></small>
                    </div>
                </div>
                
                <div class="form-group">
                    <input type="email" class="form-control" placeholder="Barua pepe" required id="regEmail">
                    <div class="form-text text-light opacity-75">
                        <small><i class="fas fa-envelope"></i> <span id="emailHelp">Tumia barua pepe halisi</span></small>
                    </div>
                </div>
                
                <div class="form-group">
                    <div class="password-input">
                        <input type="password" class="form-control" placeholder="Nenosiri" required id="regPassword">
                        <button type="button" class="toggle-password" onclick="togglePassword('regPassword')">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                    <div class="password-strength">
                        <div class="password-strength-bar" id="passwordStrengthBar"></div>
                    </div>
                    <div class="password-strength-text" id="passwordStrengthText">Nguvu ya nenosiri</div>
                    
                    <!-- Password Requirements -->
                    <div class="password-requirements">
                        <div class="requirement" id="reqLength">
                            <i class="fas fa-circle" style="font-size: 0.5rem;"></i>
                            <span id="reqLengthText">Herufi 8 au zaidi</span>
                        </div>
                        <div class="requirement" id="reqUpperLower">
                            <i class="fas fa-circle" style="font-size: 0.5rem;"></i>
                            <span id="reqCaseText">Herufi kubwa na ndogo</span>
                        </div>
                        <div class="requirement" id="reqNumber">
                            <i class="fas fa-circle" style="font-size: 0.5rem;"></i>
                            <span id="reqNumberText">Angalau nambari 1</span>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <div class="password-input">
                        <input type="password" class="form-control" placeholder="Thibitisha nenosiri" required id="regConfirmPassword">
                        <button type="button" class="toggle-password" onclick="togglePassword('regConfirmPassword')">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                    <div class="form-text text-light opacity-75">
                        <small><i class="fas fa-shield-alt"></i> <span id="confirmHelp">Weka nenosiri tena</span></small>
                    </div>
                </div>

                <div class="form-check">
                    <input class="form-check-input" type="checkbox" required id="acceptTerms">
                    <label class="form-check-label" for="acceptTerms">
                        <span id="termsText">Nakubali</span> 
                        <a onclick="showTerms()"><span id="termsLink">Sheria na Masharti</span></a>
                    </label>
                </div>

                <button type="submit" class="submit-btn">
                    <span class="btn-text"><i class="fas fa-user-plus"></i> <span id="registerBtnText">Jisajili</span></span>
                    <span class="btn-loading"><i class="fas fa-spinner fa-spin"></i> <span id="loadingText">Inasajili...</span></span>
                </button>
                
                <div id="registerAlert" class="mt-3"></div>
            </form>

            <div class="login-link">
                <p><span id="haveAccountText">Tayari una akaunti?</span> <a onclick="goToLogin()"><span id="loginLinkText">Ingia hapa</span></a></p>
            </div>
            
            <div class="back-link">
                <a onclick="goToHome()"><span id="backLinkText">‚Üê Rudi nyumbani</span></a>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // Language state
        let currentLanguage = 'sw';

        // Toggle password visibility
        function togglePassword(inputId) {
            const passwordInput = document.getElementById(inputId);
            const toggleIcon = passwordInput.nextElementSibling.querySelector('i');
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                toggleIcon.className = 'fas fa-eye-slash';
            } else {
                passwordInput.type = 'password';
                toggleIcon.className = 'fas fa-eye';
            }
        }

        // Navigation functions
        function goToLogin() { 
            window.location.href = 'login.html'; 
        }
        
        function goToHome() { 
            window.location.href = 'index.html'; 
        }

        // Enhanced terms modal
        function showTerms() {
            const termsContent = currentLanguage === 'sw' 
                ? `SHERIA NA MASHARTI YA MFUMO

1. Tumia mfumo kwa madhumuni halali ya biashara tu
2. Weka taarifa sahihi za mtumiaji
3. Hifadhi siri ya nenosiri lako
4. Rudisha vyema vifaa vya mfumo

Nakubali kufuata sheria na masharti haya.`
                : `TERMS AND CONDITIONS

1. Use the system for legitimate business purposes only
2. Provide accurate user information
3. Maintain password confidentiality
4. Return system equipment properly

I agree to comply with these terms and conditions.`;

            if (confirm(termsContent)) {
                document.getElementById('acceptTerms').checked = true;
            }
        }

        // Password strength checker
        function checkPasswordStrength(password) {
            const requirements = {
                length: password.length >= 8,
                upperLower: /[a-z]/.test(password) && /[A-Z]/.test(password),
                number: /\d/.test(password)
            };

            // Update requirement indicators
            Object.keys(requirements).forEach(req => {
                const element = document.getElementById(`req${req.charAt(0).toUpperCase() + req.slice(1)}`);
                const icon = element.querySelector('i');
                if (requirements[req]) {
                    element.classList.add('valid');
                    icon.className = 'fas fa-check-circle';
                    icon.style.color = 'var(--success)';
                } else {
                    element.classList.remove('valid');
                    icon.className = 'fas fa-circle';
                    icon.style.color = 'rgba(255,255,255,0.5)';
                }
            });

            // Calculate strength score
            let strength = 0;
            Object.values(requirements).forEach(req => {
                if (req) strength += 33;
            });

            // Update strength bar and text
            const strengthBar = document.getElementById('passwordStrengthBar');
            const strengthText = document.getElementById('passwordStrengthText');
            
            let text = '';
            let color = '';
            
            if (strength <= 33) {
                text = currentLanguage === 'sw' ? 'Dhaifu' : 'Weak';
                color = '#dc2626';
            } else if (strength <= 66) {
                text = currentLanguage === 'sw' ? 'Wastani' : 'Fair';
                color = '#f59e0b';
            } else {
                text = currentLanguage === 'sw' ? 'Imara' : 'Strong';
                color = '#059669';
            }
            
            strengthBar.style.width = strength + '%';
            strengthBar.style.background = color;
            strengthText.textContent = `${currentLanguage === 'sw' ? 'Nguvu ya nenosiri' : 'Password strength'}: ${text}`;
            strengthText.style.color = color;

            return requirements;
        }

        // Real-time password validation
        document.getElementById('regPassword').addEventListener('input', function(e) {
            checkPasswordStrength(e.target.value);
        });

        // Real-time confirm password validation
        document.getElementById('regConfirmPassword').addEventListener('input', function(e) {
            const password = document.getElementById('regPassword').value;
            const confirmPassword = e.target.value;
            
            if (confirmPassword && password !== confirmPassword) {
                e.target.classList.add('is-invalid');
                e.target.classList.remove('is-valid');
            } else if (confirmPassword && password === confirmPassword) {
                e.target.classList.add('is-valid');
                e.target.classList.remove('is-invalid');
            } else {
                e.target.classList.remove('is-invalid', 'is-valid');
            }
        });

        // Language toggle function
        function toggleLanguage() {
            currentLanguage = currentLanguage === 'sw' ? 'en' : 'sw';
            updateLanguage();
        }

        // Update all text based on current language
        function updateLanguage() {
            const texts = {
                sw: {
                    title: 'Jisajili',
                    subtitle: 'Fungua Akaunti Mpya',
                    namePlaceholder: 'Jina kamili',
                    emailPlaceholder: 'Barua pepe',
                    passwordPlaceholder: 'Nenosiri',
                    confirmPlaceholder: 'Thibitisha nenosiri',
                    nameHelp: 'Jina kamili kama kwenye hati',
                    emailHelp: 'Tumia barua pepe halisi',
                    confirmHelp: 'Weka nenosiri tena',
                    termsText: 'Nakubali',
                    termsLink: 'Sheria na Masharti',
                    registerBtn: 'Jisajili',
                    loading: 'Inasajili...',
                    haveAccount: 'Tayari una akaunti?',
                    loginLink: 'Ingia hapa',
                    backLink: '‚Üê Rudi nyumbani',
                    lang: 'English',
                    reqLength: 'Herufi 8 au zaidi',
                    reqCase: 'Herufi kubwa na ndogo',
                    reqNumber: 'Angalau nambari 1'
                },
                en: {
                    title: 'Register',
                    subtitle: 'Create New Account',
                    namePlaceholder: 'Full name',
                    emailPlaceholder: 'Email',
                    passwordPlaceholder: 'Password',
                    confirmPlaceholder: 'Confirm password',
                    nameHelp: 'Full name as on ID',
                    emailHelp: 'Use a valid email',
                    confirmHelp: 'Re-enter password',
                    termsText: 'I accept the',
                    termsLink: 'Terms and Conditions',
                    registerBtn: 'Sign Up',
                    loading: 'Registering...',
                    haveAccount: 'Already have an account?',
                    loginLink: 'Sign in here',
                    backLink: '‚Üê Back to home',
                    lang: 'Kiswahili',
                    reqLength: '8+ characters',
                    reqCase: 'Uppercase & lowercase',
                    reqNumber: 'At least 1 number'
                }
            };

            const lang = texts[currentLanguage];
            
            // Update all text elements
            document.getElementById('registerTitle').textContent = lang.title;
            document.getElementById('registerSubtitle').textContent = lang.subtitle;
            document.getElementById('regFullName').placeholder = lang.namePlaceholder;
            document.getElementById('regEmail').placeholder = lang.emailPlaceholder;
            document.getElementById('regPassword').placeholder = lang.passwordPlaceholder;
            document.getElementById('regConfirmPassword').placeholder = lang.confirmPlaceholder;
            document.getElementById('nameHelp').textContent = lang.nameHelp;
            document.getElementById('emailHelp').textContent = lang.emailHelp;
            document.getElementById('confirmHelp').textContent = lang.confirmHelp;
            document.getElementById('termsText').textContent = lang.termsText;
            document.getElementById('termsLink').textContent = lang.termsLink;
            document.getElementById('registerBtnText').textContent = lang.registerBtn;
            document.getElementById('loadingText').textContent = lang.loading;
            document.getElementById('haveAccountText').textContent = lang.haveAccount;
            document.getElementById('loginLinkText').textContent = lang.loginLink;
            document.getElementById('backLinkText').textContent = lang.backLink;
            document.getElementById('langText').textContent = lang.lang;
            
            // Update password requirements
            document.getElementById('reqLengthText').textContent = lang.reqLength;
            document.getElementById('reqCaseText').textContent = lang.reqCase;
            document.getElementById('reqNumberText').textContent = lang.reqNumber;

            // Re-check password to update strength text
            const currentPassword = document.getElementById('regPassword').value;
            if (currentPassword) {
                checkPasswordStrength(currentPassword);
            }
        }

        // Show alert function
        function showAlert(alertId, message, type) {
            const alertDiv = document.getElementById(alertId);
            if (alertDiv) {
                alertDiv.innerHTML = `
                    <div class="alert alert-${type} alert-dismissible fade show">
                        ${message}
                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    </div>`;
                
                // Auto remove after 8 seconds
                setTimeout(() => {
                    if (alertDiv.firstChild) {
                        alertDiv.firstChild.remove();
                    }
                }, 8000);
            }
        }

        // Registration form handler
        document.getElementById('registerForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const fullName = document.getElementById('regFullName').value.trim();
            const email = document.getElementById('regEmail').value.trim();
            const password = document.getElementById('regPassword').value;
            const confirmPassword = document.getElementById('regConfirmPassword').value;

            // Validation
            if (password !== confirmPassword) {
                showAlert('registerAlert', 
                    currentLanguage === 'sw' 
                        ? '‚ùå Nenosiri halifanani!' 
                        : '‚ùå Passwords do not match!', 
                    'danger');
                return;
            }

            const requirements = checkPasswordStrength(password);
            const validPassword = Object.values(requirements).every(req => req);
            
            if (!validPassword) {
                showAlert('registerAlert', 
                    currentLanguage === 'sw' 
                        ? '‚ùå Nenosiri halikidhi mahitaji yote!' 
                        : '‚ùå Password does not meet all requirements!', 
                    'danger');
                return;
            }

            const submitBtn = this.querySelector('.submit-btn');
            const btnText = submitBtn.querySelector('.btn-text');
            const btnLoading = submitBtn.querySelector('.btn-loading');

            // Show loading state
            btnText.style.display = 'none';
            btnLoading.style.display = 'inline-flex';
            submitBtn.disabled = true;

            try {
                const response = await fetch('/api/register', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    'Accept': 'application/json'
                    },
                    body: JSON.stringify({
                        full_name: fullName,
                        email: email,
                        password: password
                    })
                });

                const result = await response.json();
                
                if (!response.ok) {
                    throw new Error(result.error);
                }

                // Store token and user data
                localStorage.setItem('token', result.token);
                localStorage.setItem('currentUser', JSON.stringify(result.user));

                // Show appropriate success message
                if (result.user.role === 'superadmin') {
                    showAlert('registerAlert', 
                        currentLanguage === 'sw' 
                            ? '‚úÖ USAJILI WA MSIMAMIZI MKUU UMEFANIKIWA! Inaelekeza...' 
                            : '‚úÖ SUPER ADMIN REGISTRATION SUCCESSFUL! Redirecting...', 
                        'success');
                    
                    setTimeout(() => {
                        window.location.href = 'dashboard.html';
                    }, 2000);
                } else {
                    showAlert('registerAlert', 
                        currentLanguage === 'sw' 
                            ? '‚úÖ Usajili umefanikiwa! Inasubiri idhini ya msimamizi.' 
                            : '‚úÖ Registration successful! Pending admin approval.', 
                        'success');
                    
                    setTimeout(() => {
                        window.location.href = 'login.html?registered=true';
                    }, 3000);
                }

            } catch (error) {
                console.error('Registration error:', error);
                
                let errorMessage = currentLanguage === 'sw' 
                    ? '‚ùå Hitilafu ya kusajili!' 
                    : '‚ùå Registration error!';

                if (error.message.includes('already exists')) {
                    errorMessage = currentLanguage === 'sw' 
                        ? '‚ùå Barua pepe imetumika!' 
                        : '‚ùå Email already used!';
                }

                showAlert('registerAlert', errorMessage, 'danger');
            } finally {
                // Reset button state
                btnText.style.display = 'inline-flex';
                btnLoading.style.display = 'none';
                submitBtn.disabled = false;
            }
        });

        // Auto-focus on name input
        document.addEventListener('DOMContentLoaded', () => {
            console.log('üöÄ Register page loaded');
            document.getElementById('regFullName').focus();
            updateLanguage(); // Initialize language
        });

        // Enter key support
        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                document.getElementById('registerForm').dispatchEvent(new Event('submit'));
            }
        });
    </script>
</body>
</html>